<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>To-Do List</title>
    <style>
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { margin: 0; padding: 20px; background: #f9f9f9; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { text-align: center; color: #333; margin-bottom: 20px; }

        .form-section {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .form-section input,
        .form-section select,
        .form-section button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-section button {
            background: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        .form-section button:hover {
            background: #218838;
        }

        .status-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding-top: 10px;
        }

        .status-column {
            min-width: 320px;
            background: #f0f0f0;
            border-radius: 8px;
            padding: 15px;
            flex-shrink: 0;
        }

        .status-column h2 {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.2em;
            color: #555;
            text-align: center;
        }

        .task {
            background: #fff;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid #3498db;
        }

        .task:hover {
            background: #f8f8f8;
            transform: translateX(2px);
        }

        .task.completed {
            background: #e3f2fd;
            border-left: 4px solid #4caf50;
        }

        .task.urgent {
            border-left: 4px solid #e74c3c;
        }

        .task-info {
            font-size: 14px;
            color: #555;
            margin-bottom: 5px;
            line-height: 1.4;
        }

        .task-actions {
            display: flex;
            justify-content: flex-end;
            gap: 5px;
        }

        .task-actions button {
            font-size: 12px;
            padding: 5px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-btn {
            background: #28a745;
            color: white;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
        }

        .status-column.drag-over {
            background: #d4edda;
            border: 2px dashed #28a745;
        }

        @media (max-width: 768px) {
            .status-container {
                flex-direction: column;
                gap: 10px;
            }
            .status-column {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>To-Do List</h1>

        <!-- Form Input -->
        <div class="form-section">
            <input type="text" id="task-input" placeholder="Tulis tugas..." />
            <input type="datetime-local" id="deadline" />
            <select id="urgency">
                <option value="normal">Biasa</option>
                <option value="urgent">Urgent</option>
            </select>
            <button id="add-task">Tambah Tugas</button>
        </div>

        <!-- Kolom Status -->
        <div class="status-container">
            <!-- Belum Dikerjakan -->
            <div class="status-column" id="todo" data-status="todo">
                <h2>Belum Dikerjakan</h2>
                <div id="todo-list"></div>
            </div>

            <!-- Sedang Dikerjakan -->
            <div class="status-column" id="in-progress" data-status="in-progress">
                <h2>Sedang Dikerjakan</h2>
                <div id="in-progress-list"></div>
            </div>

            <!-- Sudah Dikerjakan -->
            <div class="status-column" id="done" data-status="done">
                <h2>Sudah Dikerjakan</h2>
                <div id="done-list"></div>
            </div>
        </div>
    </div>

    <script>
        // Data tugas
        let tasks = JSON.parse(localStorage.getItem("tasks")) || [];

        // DOM Elements
        const taskInput = document.getElementById("task-input");
        const deadlineInput = document.getElementById("deadline");
        const urgencySelect = document.getElementById("urgency");
        const addTaskBtn = document.getElementById("add-task");
        const todoList = document.getElementById("todo-list");
        const inProgressList = document.getElementById("in-progress-list");
        const doneList = document.getElementById("done-list");

        // Fungsi: Simpan ke localStorage
        function saveTasks() {
            localStorage.setItem("tasks", JSON.stringify(tasks));
        }

        // Fungsi: Render semua tugas ke kolom
        function renderTasks() {
            // Kosongkan semua kolom
            todoList.innerHTML = "";
            inProgressList.innerHTML = "";
            doneList.innerHTML = "";

            tasks.forEach((task, index) => {
                const taskElement = document.createElement("div");
                taskElement.classList.add("task");
                taskElement.setAttribute("data-index", index);

                // Set status & warna
                if (task.status === "done") taskElement.classList.add("completed");
                if (task.urgency === "urgent") taskElement.classList.add("urgent");

                // Tambah info
                const infoText = `
                    <div class="task-info">
                        <strong>${task.text}</strong>
                        <br><small>Deadline: ${task.deadline}</small>
                    </div>
                `;
                taskElement.innerHTML = infoText;

                // Tambah tombol
                const buttons = `
                    <div class="task-actions">
                        <button class="edit-btn" data-action="edit">Edit</button>
                        <button class="delete-btn" data-action="delete">Hapus</button>
                    </div>
                `;
                taskElement.innerHTML += buttons;

                // Tambah ke kolom
                if (task.status === "todo") todoList.appendChild(taskElement);
                else if (task.status === "in-progress") inProgressList.appendChild(taskElement);
                else if (task.status === "done") doneList.appendChild(taskElement);

                // Event: Drag & Drop (ganti status)
                taskElement.addEventListener("dragstart", function () {
                    this.style.opacity = "0.4";
                    this.dataset.from = this.parentNode.id;
                });

                taskElement.addEventListener("dragend", function () {
                    this.style.opacity = "1";
                });

                // Event: Ganti status (satu klik)
                taskElement.addEventListener("click", function () {
                    if (this.classList.contains("completed")) return;
                    const taskIndex = this.dataset.index;
                    const statusMap = { todo: "in-progress", "in-progress": "done", done: "todo" };
                    const newStatus = statusMap[tasks[taskIndex].status];
                    tasks[taskIndex].status = newStatus;
                    saveTasks();
                    renderTasks();
                });

                // Event: Edit
                taskElement.querySelector(".edit-btn").addEventListener("click", function () {
                    const input = prompt("Edit tugas:", tasks[index].text);
                    if (input !== null && input.trim() !== "") {
                        tasks[index].text = input.trim();
                        saveTasks();
                        renderTasks();
                    }
                });

                // Event: Hapus
                taskElement.querySelector(".delete-btn").addEventListener("click", function () {
                    tasks.splice(index, 1);
                    saveTasks();
                    renderTasks();
                });
            });
        }

        // Event: Tambah tugas
        addTaskBtn.addEventListener("click", function () {
            const text = taskInput.value.trim();
            if (!text) return alert("Tugas tidak boleh kosong!");
            const deadline = deadlineInput.value || "Tidak ada deadline";
            const urgency = urgencySelect.value;
            const status = "todo";

            const newTask = { text, deadline, urgency, status };
            tasks.push(newTask);
            saveTasks();
            taskInput.value = "";
            deadlineInput.value = "";
            renderTasks();
        });

        // Drag & Drop Setup
        ["todo", "in-progress", "done"].forEach(id => {
            const col = document.getElementById(id);
            col.addEventListener("dragover", e => {
                e.preventDefault();
                e.dataTransfer.dropEffect = "move";
                col.classList.add("drag-over");
            });
            col.addEventListener("dragleave", () => col.classList.remove("drag-over"));
            col.addEventListener("drop", function (e) {
                e.preventDefault();
                const from = e.dataTransfer.getData("text");
                const taskElement = document.querySelector(`[data-index="${e.dataTransfer.getData("index")}"]`);
                const taskIndex = taskElement.dataset.index;
                const newStatus = this.dataset.status;
                tasks[taskIndex].status = newStatus;
                saveTasks();
                renderTasks();
                this.classList.remove("drag-over");
            });
        });

        // Load tasks saat pertama kali
        renderTasks();
    </script>
</body>
</html>
